"use strict";!function(){function t(t){this.targetTypes={},this.templates={}}function e(t){var e=t.toLowerCase();no.targetTypes[e]={},no.targetTypes[e].process=function(t,e){("trigger"!==t.actionType||e.length>0)&&(t.invalid=!0)},no.targetTypes[e].apply=function(e,n,a){a[t]()}}t.prototype.splitParams=function(t){if(null==t)return null;for(var e=[],n="",a=!1,i=!1,s=!1,o=!1,r=!0,l=0;l<t.length;l++){var p=t.charAt(l);if(o){if("'"!==p&&"\\"!==p&&!/\s/.exec(p))return"invalid";n+=p,o=!1,r=!1,i=!1,s=!1}else if(!r&&!i&&a||"'"!==p)if(a&&"'"===p)a=!1,s=!0,e.push(n),n="";else if(!a&&/\s/.exec(p))r||i||s||(e.push(n),n=""),i=!0,s=!1;else if("\\"===p)o=!0,r=!1,i=!1,s=!1;else{if(s)return"invalid";r=!1,i=!1,s=!1,n+=p}else{if(!r&&!i)return"invalid";a=!0,r=!1,i=!1}}return a?"invalid":(s||i||r||e.push(n),e)},t.prototype.processTrigger=function(t,e){var n={};return n.eventType=t.shift(),n.invalid=!1,"timeout"===t[0]?(t.shift(),n.timeout={},n.timeout.time=parseInt(e.shift()),n.timeout.count=parseInt(e.shift()),(isNaN(n.timeout.time)||isNaN(n.timeout.count))&&(n.invalid=!0)):n.timeout=null,n},t.prototype.processAction=function(t,e,n){var a={};a.actionType=t.shift(),a.targetType=t.shift().toLowerCase(),a.sourceElement=n,a.isSelf="self"===t[t.length-1],a.isSelf?a.target=n:a.target=e.shift(),a.invalid=!1;var i=this.targetTypes[a.targetType];return null==a.actionType||null==a.targetType||null==i||null==a.target?a.invalid=!0:i.process(a,e),a},t.prototype.processListener=function(t,e,n){var a=this.targetTypes[e.targetType];if(null!=a){var i=function(t){if(e.isSelf)a.apply(t,e,e.target);else{document.querySelectorAll(e.target).forEach(function(n){a.apply(t,e,n)})}},s=null;if(null==t.timeout)s=i;else if(t.timeout.count>0){var o=t.timeout.count;s=function(e){o-- >0?(i(e),setTimeout(s,t.timeout.time)):o=t.timeout.count}}else s=function(e){setInterval(function(){i(e)},t.timeout.time)};"immediately"===t.eventType?setTimeout(function(){s(null)}):n.addEventListener(t.eventType,s)}},t.prototype.templateArgs=function(t,e){for(var n=0;n<t.length;n++)for(var a=0;a<e.length;a++){var i=new RegExp("\\$"+a,"g");t[n]=t[n].replace(i,e[a])}},t.prototype.processTemplate=function(t,e){var n=this.splitParams(e);"invalid"===n&&console.warn('invalid no-js template no-js="'+e+'"');var a=this.templates[n.shift()];null!=a&&a.argc===n.length||console.warn('invalid no-js template no-js="'+e+'"');for(var i=0;i<a.copyActions.length;i++){var s=a.copyActions[i].keyStr.split("-");s.shift();var o=this.splitParams(a.copyActions[i].valStr);this.templateArgs(o,n);var r=this.processTrigger(s,o),l=this.processAction(s,o,t);l.invalid||r.invalid?console.warn('invalid no-js template no-js="'+e+'"'):this.processListener(r,l,t)}},t.prototype.processElement=function(t){var e=this;Object.keys(t.attributes).forEach(function(n){var a=t.attributes[n],i=!1;if("no-js"===a.name&&null!=a.value&&""!==a.value)return void e.processTemplate(t,a.value);if(0===a.name.indexOf("on--"))i=!0,console.warn('Deprecation warning: using double dashes "--" are deprecated. Use a single dash "-" instead.');else if(0!==a.name.indexOf("on-"))return;var s=a.name.split(i?"--":"-");s.shift();var o=e.splitParams(a.value);"invalid"===o&&console.warn("invalid no-js parameter "+a.name+'="'+a.value+'"');var r=e.processTrigger(s,o),l=e.processAction(s,o,t);l.invalid||r.invalid?console.warn("invalid no-js attribute "+a.name+'="'+a.value+'"'):e.processListener(r,l,t)})},t.prototype.processMeta=function(t){var e={};e.copyActions=[],e.applyActions=[];var n=null;Object.keys(t.attributes).forEach(function(a){var i=t.attributes[a];if("no-js"==i.name)n=i.value;else if(0===i.name.indexOf("on-")){var s={};s.keyStr=i.name,s.valStr=i.value,e.copyActions.push(s)}else{var o={};o.keyStr=i.name,o.valStr=i.value,e.applyActions.push(o)}});var a=this.splitParams(n);null!=a&&2===a.length&&(e.argc=parseInt(a[1])),null==e.argc||isNaN(e.argc)||null!=this.templates[a[0]]?(console.warn("invalid no-js meta template"),console.warn(t)):this.templates[a[0]]=e},t.prototype.js=function(t){var e=this;t=t||"html",document.querySelector(t).querySelectorAll("[no-js]").forEach(function(t){"meta"===t.tagName.toLowerCase()?e.processMeta(t):e.processElement(t)})},window.no=new t,no.targetTypes.attribute={},no.targetTypes.attribute.process=function(t,e){"add"===t.actionType||"set"===t.actionType?e.length>=2?(t.attributeName=e.shift(),t.attributeValue=e.join(" ")):t.invalid=!0:"remove"===t.actionType&&1===e.length?t.attributeName=e.shift():t.invalid=!0},no.targetTypes.attribute.apply=function(t,e,n){"remove"===e.actionType?n.removeAttribute(e.attributeName):n.setAttribute(e.attributeName,e.attributeValue)},no.targetTypes.class={},no.targetTypes.class.process=function(t,e){"add"===t.actionType||"set"===t.actionType||"remove"===t.actionType||"toggle"===t.actionType||"switch"===t.actionType?t.classNames=e:t.invalid=!0},no.targetTypes.class.apply=function(t,e,n){"set"===e.actionType?n.className=e.classNames.join(" "):"switch"===e.actionType?e.classNames.forEach(function(t){n.classList.remove(t),e.sourceElement.classList.add(t)}):e.classNames.forEach(function(t){n.classList[e.actionType](t)})},no.targetTypes.id={},no.targetTypes.id.process=function(t,e){t.targetType="attribute",e.unshift("id"),no.targetTypes.attribute.process(t,e)},no.targetTypes.dom={},no.targetTypes.dom.process=function(t,e){"remove"!==t.actionType&&0!=e.length&&t.invalid},no.targetTypes.dom.apply=function(t,e,n){"remove"===e.actionType&&n.remove()},no.targetTypes.value={},no.targetTypes.value.process=function(t,e){"set"===t.actionType?t.value=e.join(" "):"reset"===t.actionType&&0===e.length||(t.invalid=!0)},no.targetTypes.value.apply=function(t,e,n){"set"===e.actionType?n.value=e.value:"reset"===e.actionType&&(n.value=null)},no.targetTypes.text={},no.targetTypes.text.process=function(t,e){"set"===t.actionType?t.text=e.join(" "):t.invalid=!0},no.targetTypes.text.apply=function(t,e,n){"set"===e.actionType&&(n.innerText=e.text)},e("click"),e("focus"),e("blur"),e("scrollIntoView"),no.targetTypes.template={},no.targetTypes.template.process=function(t,e){"apply"===t.actionType&&(t.template=t.target,t.target=t.sourceElement,t.isSelf=!0,t.args=e)},no.targetTypes.template.apply=function(t,e,n){for(var a=no.templates[e.template],i=0;i<a.applyActions.length;i++){var s=a.applyActions[i].keyStr.split("-"),o=no.splitParams(a.applyActions[i].valStr);no.templateArgs(o,e.args);var r=no.processAction(s,o,n);r.isSelf?no.targetTypes[r.targetType].apply(t,r,n):document.querySelectorAll(r.target).forEach(function(e){no.targetTypes[r.targetType].apply(t,r,e)})}},document.addEventListener("DOMContentLoaded",function(){no.js()})}();